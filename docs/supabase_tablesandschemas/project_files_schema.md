create table public.project_files ( uuid uuid not null default gen_random_uuid (), user_id uuid not null, tenant_id uuid not null, ui_name text not null, file_path text not null, parsed_path text null, file_type text not null default 'unstructured'::text, mime_type text null, file_size bigint null, file_hash text null, file_checksum text null, status text not null default 'uploaded'::text, processing_status text null default 'pending'::text, processing_errors jsonb null, ingestion_type text null default 'upload'::text, created_by text null, updated_by text null, client_ip inet null, user_agent text null, access_level text null default 'open'::text, permissions jsonb null, data_classification text null default 'public'::text, retention_policy text null, compliance_flags jsonb null, pillar_origin text null default 'content_pillar'::text, service_context jsonb null, processing_pipeline jsonb null, arango_content_id uuid null, lineage_depth integer null default 0, root_file_uuid uuid null, parent_file_uuid uuid null, generation integer null default 0, lineage_path text null, version integer null default 1, insights jsonb null, archived_at timestamp with time zone null, archive_reason text null, purged_at timestamp with time zone null, created_at timestamp with time zone not null default now(), updated_at timestamp with time zone not null default now(), deleted boolean not null default false, artifact_type text null, boundary_contract_id uuid null, representation_type text null, materialization_policy_basis text null, materialization_ttl interval null, materialization_expires_at timestamp with time zone null, materialization_backing_store text null, source_external boolean null default true, source_location text null, source_type text null, materialization_scope jsonb null, constraint project_files_pkey primary key (uuid), constraint project_files_boundary_contract_id_fkey foreign KEY (boundary_contract_id) references data_boundary_contracts (contract_id), constraint project_files_file_type_check check ( ( file_type = any ( array[ 'structured'::text, 'unstructured'::text, 'hybrid'::text ] ) ) ), constraint project_files_materialization_backing_store_check check ( ( (materialization_backing_store is null) or ( materialization_backing_store = any ( array[ 'gcs'::text, 'supabase'::text, 'memory'::text, 'none'::text ] ) ) ) ), constraint project_files_representation_type_check check ( ( (representation_type is null) or ( representation_type = any ( array[ 'reference'::text, 'partial_extraction'::text, 'deterministic'::text, 'semantic_embedding'::text, 'full_artifact'::text ] ) ) ) ) ) TABLESPACE pg_default; create index IF not exists idx_project_files_artifact_type on public.project_files using btree (artifact_type) TABLESPACE pg_default where (artifact_type is not null); create index IF not exists idx_project_files_artifact_tenant on public.project_files using btree (artifact_type, tenant_id) TABLESPACE pg_default where (artifact_type is not null); create index IF not exists idx_project_files_boundary_contract_id on public.project_files using btree (boundary_contract_id) TABLESPACE pg_default; create index IF not exists idx_project_files_representation_type on public.project_files using btree (representation_type) TABLESPACE pg_default; create index IF not exists idx_project_files_materialization_expires_at on public.project_files using btree (materialization_expires_at) TABLESPACE pg_default where (materialization_expires_at is not null); create index IF not exists idx_project_files_source_external on public.project_files using btree (source_external) TABLESPACE pg_default; create index IF not exists idx_project_files_materialization_scope on public.project_files using gin (materialization_scope) TABLESPACE pg_default; create index IF not exists idx_project_files_tenant_id on public.project_files using btree (tenant_id) TABLESPACE pg_default; create index IF not exists idx_project_files_user_id on public.project_files using btree (user_id) TABLESPACE pg_default; create index IF not exists idx_project_files_status on public.project_files using btree (status) TABLESPACE pg_default; create index IF not exists idx_project_files_processing_status on public.project_files using btree (processing_status) TABLESPACE pg_default; create index IF not exists idx_project_files_deleted on public.project_files using btree (deleted) TABLESPACE pg_default; create index IF not exists idx_project_files_file_path on public.project_files using btree (file_path) TABLESPACE pg_default; create index IF not exists idx_project_files_created_at on public.project_files using btree (created_at desc) TABLESPACE pg_default; create index IF not exists idx_project_files_pillar_origin on public.project_files using btree (pillar_origin) TABLESPACE pg_default; create index IF not exists idx_project_files_parent_file_uuid on public.project_files using btree (parent_file_uuid) TABLESPACE pg_default; create index IF not exists idx_project_files_root_file_uuid on public.project_files using btree (root_file_uuid) TABLESPACE pg_default; create index IF not exists idx_project_files_lineage_depth on public.project_files using btree (lineage_depth) TABLESPACE pg_default; create index IF not exists idx_project_files_tenant_status on public.project_files using btree (tenant_id, status, deleted) TABLESPACE pg_default; create index IF not exists idx_project_files_lineage on public.project_files using btree (root_file_uuid, lineage_depth, generation) TABLESPACE pg_default;
create table public.project_files ( uuid uuid not null default gen_random_uuid (), user_id uuid not null, tenant_id uuid not null, ui_name text not null, file_path text not null, parsed_path text null, file_type text not null default 'unstructured'::text, mime_type text null, file_size bigint null, file_hash text null, file_checksum text null, status text not null default 'uploaded'::text, processing_status text null default 'pending'::text, processing_errors jsonb null, ingestion_type text null default 'upload'::text, created_by text null, updated_by text null, client_ip inet null, user_agent text null, access_level text null default 'open'::text, permissions jsonb null, data_classification text null default 'public'::text, retention_policy text null, compliance_flags jsonb null, pillar_origin text null default 'content_pillar'::text, service_context jsonb null, processing_pipeline jsonb null, arango_content_id uuid null, lineage_depth integer null default 0, root_file_uuid uuid null, parent_file_uuid uuid null, generation integer null default 0, lineage_path text null, version integer null default 1, insights jsonb null, archived_at timestamp with time zone null, archive_reason text null, purged_at timestamp with time zone null, created_at timestamp with time zone not null default now(), updated_at timestamp with time zone not null default now(), deleted boolean not null default false, artifact_type text null, boundary_contract_id uuid null, representation_type text null, materialization_policy_basis text null, materialization_ttl interval null, materialization_expires_at timestamp with time zone null, materialization_backing_store text null, source_external boolean null default true, source_location text null, source_type text null, materialization_scope jsonb null, constraint project_files_pkey primary key (uuid), constraint project_files_boundary_contract_id_fkey foreign KEY (boundary_contract_id) references data_boundary_contracts (contract_id), constraint project_files_file_type_check check ( ( file_type = any ( array[ 'structured'::text, 'unstructured'::text, 'hybrid'::text ] ) ) ), constraint project_files_materialization_backing_store_check check ( ( (materialization_backing_store is null) or ( materialization_backing_store = any ( array[ 'gcs'::text, 'supabase'::text, 'memory'::text, 'none'::text ] ) ) ) ), constraint project_files_representation_type_check check ( ( (representation_type is null) or ( representation_type = any ( array[ 'reference'::text, 'partial_extraction'::text, 'deterministic'::text, 'semantic_embedding'::text, 'full_artifact'::text ] ) ) ) ) ) TABLESPACE pg_default; create index IF not exists idx_project_files_artifact_type on public.project_files using btree (artifact_type) TABLESPACE pg_default where (artifact_type is not null); create index IF not exists idx_project_files_artifact_tenant on public.project_files using btree (artifact_type, tenant_id) TABLESPACE pg_default where (artifact_type is not null); create index IF not exists idx_project_files_boundary_contract_id on public.project_files using btree (boundary_contract_id) TABLESPACE pg_default; create index IF not exists idx_project_files_representation_type on public.project_files using btree (representation_type) TABLESPACE pg_default; create index IF not exists idx_project_files_materialization_expires_at on public.project_files using btree (materialization_expires_at) TABLESPACE pg_default where (materialization_expires_at is not null); create index IF not exists idx_project_files_source_external on public.project_files using btree (source_external) TABLESPACE pg_default; create index IF not exists idx_project_files_materialization_scope on public.project_files using gin (materialization_scope) TABLESPACE pg_default; create index IF not exists idx_project_files_tenant_id on public.project_files using btree (tenant_id) TABLESPACE pg_default; create index IF not exists idx_project_files_user_id on public.project_files using btree (user_id) TABLESPACE pg_default; create index IF not exists idx_project_files_status on public.project_files using btree (status) TABLESPACE pg_default; create index IF not exists idx_project_files_processing_status on public.project_files using btree (processing_status) TABLESPACE pg_default; create index IF not exists idx_project_files_deleted on public.project_files using btree (deleted) TABLESPACE pg_default; create index IF not exists idx_project_files_file_path on public.project_files using btree (file_path) TABLESPACE pg_default; create index IF not exists idx_project_files_created_at on public.project_files using btree (created_at desc) TABLESPACE pg_default; create index IF not exists idx_project_files_pillar_origin on public.project_files using btree (pillar_origin) TABLESPACE pg_default; create index IF not exists idx_project_files_parent_file_uuid on public.project_files using btree (parent_file_uuid) TABLESPACE pg_default; create index IF not exists idx_project_files_root_file_uuid on public.project_files using btree (root_file_uuid) TABLESPACE pg_default; create index IF not exists idx_project_files_lineage_depth on public.project_files using btree (lineage_depth) TABLESPACE pg_default; create index IF not exists idx_project_files_tenant_status on public.project_files using btree (tenant_id, status, deleted) TABLESPACE pg_default; create index IF not exists idx_project_files_lineage on public.project_files using btree (root_file_uuid, lineage_depth, generation) TABLESPACE pg_default;